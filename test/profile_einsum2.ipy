import einsum2
import numpy as np

#I,J,K,L = np.random.randint(10, 20, size=4)
#I = J = K = L = 300
I = J = K = L = 100

A = np.random.normal(size=(I,J,K))
B = np.random.normal(size=(I,K,L))

print("Timing np.matmul")
%timeit np.matmul(A , B)

for j in (1,2,4):
    print("Timing einsum2.batched_dot with %d threads" % j)
    %timeit einsum2.batched_dot(A,B, threads=j)

for j in (1,2,4):
    print("Timing einsum2.einsum2 with %d threads" % j)
    %timeit einsum2.einsum2(A, ("i","j","k"), B, ("i", "k", "l"), ("i", "j", "l"), threads=j)
